{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/dtysh/OneDrive/Documents/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"C:/Users/dtysh/OneDrive/Documents/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _objectDestructuringEmpty from\"C:/Users/dtysh/OneDrive/Documents/node_modules/@babel/runtime/helpers/esm/objectDestructuringEmpty.js\";import _toConsumableArray from\"C:/Users/dtysh/OneDrive/Documents/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"C:/Users/dtysh/OneDrive/Documents/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/dtysh/OneDrive/Documents/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import axios from\"axios\";import Joke from\"./Joke\";import\"./JokeList.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function JokeList(_ref){var _ref$numJokesToGet=_ref.numJokesToGet,numJokesToGet=_ref$numJokesToGet===void 0?5:_ref$numJokesToGet;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),jokes=_useState2[0],setJokes=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];/* get jokes if there are no jokes */useEffect(function(){function getJokes(){return _getJokes.apply(this,arguments);}function _getJokes(){_getJokes=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var j,seenJokes,res,jokeObj;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:j=_toConsumableArray(jokes);seenJokes=new Set();_context.prev=2;case 3:if(!(j.length<numJokesToGet)){_context.next=11;break;}_context.next=6;return axios.get(\"https://icanhazdadjoke.com\",{headers:{Accept:\"application/json\"}});case 6:res=_context.sent;jokeObj=Object.assign({},(_objectDestructuringEmpty(res.data),res.data));if(!seenJokes.has(jokeObj.id)){seenJokes.add(jokeObj.id);j.push(_objectSpread(_objectSpread({},jokeObj),{},{votes:0}));}else{console.error(\"duplicate found!\");}_context.next=3;break;case 11:setJokes(j);setIsLoading(false);_context.next=18;break;case 15:_context.prev=15;_context.t0=_context[\"catch\"](2);console.error(_context.t0);case 18:case\"end\":return _context.stop();}},_callee,null,[[2,15]]);}));return _getJokes.apply(this,arguments);}if(jokes.length===0)getJokes();},[jokes,numJokesToGet]);/* empty joke list and then call getJokes */function generateNewJokes(){setJokes([]);setIsLoading(true);}/* change vote for this id by delta (+1 or -1) */function vote(id,delta){setJokes(function(allJokes){return allJokes.map(function(j){return j.id===id?_objectSpread(_objectSpread({},j),{},{votes:j.votes+delta}):j;});});}/* render: either loading spinner or list of sorted jokes. */if(isLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-4x fa-spinner fa-spin\"})});}var sortedJokes=_toConsumableArray(jokes).sort(function(a,b){return b.votes-a.votes;});return/*#__PURE__*/_jsxs(\"div\",{className:\"JokeList\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"JokeList-getmore\",onClick:generateNewJokes,children:\"Get New Jokes\"}),sortedJokes.map(function(_ref2){var joke=_ref2.joke,id=_ref2.id,votes=_ref2.votes;return/*#__PURE__*/_jsx(Joke,{text:joke,id:id,votes:votes,vote:vote},id);})]});}export default JokeList;","map":{"version":3,"names":["React","useState","useEffect","axios","Joke","jsx","_jsx","jsxs","_jsxs","JokeList","_ref","_ref$numJokesToGet","numJokesToGet","_useState","_useState2","_slicedToArray","jokes","setJokes","_useState3","_useState4","isLoading","setIsLoading","getJokes","_getJokes","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","j","seenJokes","res","jokeObj","wrap","_callee$","_context","prev","next","_toConsumableArray","Set","length","get","headers","Accept","sent","Object","assign","_objectDestructuringEmpty","data","has","id","add","push","_objectSpread","votes","console","error","t0","stop","generateNewJokes","vote","delta","allJokes","map","className","children","sortedJokes","sort","a","b","onClick","_ref2","joke","text"],"sources":["C:/Users/dtysh/OneDrive/Documents/react-jokes-classes/react-jokes-classes/src/JokeList.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport Joke from \"./Joke\";\nimport \"./JokeList.css\";\n\nfunction JokeList({ numJokesToGet = 5 }) {\n  const [jokes, setJokes] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n\n  /* get jokes if there are no jokes */\n\n  useEffect(function () {\n    async function getJokes() {\n      let j = [...jokes];\n      let seenJokes = new Set();\n      try {\n        while (j.length < numJokesToGet) {\n          let res = await axios.get(\"https://icanhazdadjoke.com\", {\n            headers: { Accept: \"application/json\" }\n          });\n          let { ...jokeObj } = res.data;\n\n          if (!seenJokes.has(jokeObj.id)) {\n            seenJokes.add(jokeObj.id);\n            j.push({ ...jokeObj, votes: 0 });\n          } else {\n            console.error(\"duplicate found!\");\n          }\n        }\n        setJokes(j);\n        setIsLoading(false)\n      } catch (err) {\n        console.error(err);\n      }\n    }\n\n    if (jokes.length === 0) getJokes();\n  }, [jokes, numJokesToGet]);\n\n  /* empty joke list and then call getJokes */\n\n  function generateNewJokes() {\n    setJokes([]);\n    setIsLoading(true);\n  }\n\n  /* change vote for this id by delta (+1 or -1) */\n\n  function vote(id, delta) {\n    setJokes(allJokes =>\n      allJokes.map(j => (j.id === id ? { ...j, votes: j.votes + delta } : j))\n    );\n  }\n\n  /* render: either loading spinner or list of sorted jokes. */\n\n  if (isLoading) {\n    return (\n      <div className=\"loading\">\n        <i className=\"fas fa-4x fa-spinner fa-spin\" />\n      </div>\n      )\n  }\n\n  let sortedJokes = [...jokes].sort((a, b) => b.votes - a.votes);\n\n  return (\n    <div className=\"JokeList\">\n      <button className=\"JokeList-getmore\" onClick={generateNewJokes}>\n        Get New Jokes\n        </button>\n\n      {sortedJokes.map(({joke, id, votes}) => (\n        <Joke text={joke} key={id} id={id} votes={votes} vote={vote} />\n      ))}\n    </div>\n  );\n}\n\nexport default JokeList;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}